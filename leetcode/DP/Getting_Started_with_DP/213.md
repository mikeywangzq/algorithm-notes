# 213. [æ‰“å®¶åŠ«èˆ II](https://leetcode.cn/problems/house-robber-ii/)

## ğŸ“‹ é¢˜ç›®æè¿°

ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å°å·ï¼Œè®¡åˆ’å·çªƒæ²¿è¡—çš„æˆ¿å±‹ï¼Œæ¯é—´æˆ¿å†…éƒ½è—æœ‰ä¸€å®šçš„ç°é‡‘ã€‚è¿™ä¸ªåœ°æ–¹æ‰€æœ‰çš„æˆ¿å±‹éƒ½**å›´æˆä¸€åœˆ**ï¼Œè¿™æ„å‘³ç€ç¬¬ä¸€ä¸ªæˆ¿å±‹å’Œæœ€åä¸€ä¸ªæˆ¿å±‹æ˜¯ç´§æŒ¨ç€çš„ã€‚åŒæ—¶ï¼Œç›¸é‚»çš„æˆ¿å±‹è£…æœ‰ç›¸äº’è¿é€šçš„é˜²ç›—ç³»ç»Ÿï¼Œå¦‚æœä¸¤é—´ç›¸é‚»çš„æˆ¿å±‹åœ¨åŒä¸€æ™šä¸Šè¢«å°å·é—¯å…¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥è­¦ã€‚

ç»™å®šä¸€ä¸ªä»£è¡¨æ¯ä¸ªæˆ¿å±‹å­˜æ”¾é‡‘é¢çš„éè´Ÿæ•´æ•°æ•°ç»„ï¼Œè®¡ç®—ä½ åœ¨**ä¸è§¦åŠ¨è­¦æŠ¥è£…ç½®çš„æƒ…å†µä¸‹**ï¼Œä»Šæ™šèƒ½å¤Ÿå·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ã€‚

**ç¤ºä¾‹ 1ï¼š**
```
è¾“å…¥ï¼šnums = [2,3,2]
è¾“å‡ºï¼š3
è§£é‡Šï¼šä½ ä¸èƒ½å…ˆå·çªƒ 1 å·æˆ¿å±‹ï¼ˆé‡‘é¢ = 2ï¼‰ï¼Œç„¶åå·çªƒ 3 å·æˆ¿å±‹ï¼ˆé‡‘é¢ = 2ï¼‰, å› ä¸ºä»–ä»¬æ˜¯ç›¸é‚»çš„ã€‚
```

**ç¤ºä¾‹ 2ï¼š**
```
è¾“å…¥ï¼šnums = [1,2,3,1]
è¾“å‡ºï¼š4
è§£é‡Šï¼šä½ å¯ä»¥å…ˆå·çªƒ 1 å·æˆ¿å±‹ï¼ˆé‡‘é¢ = 1ï¼‰ï¼Œç„¶åå·çªƒ 3 å·æˆ¿å±‹ï¼ˆé‡‘é¢ = 3ï¼‰ã€‚
     å·çªƒåˆ°çš„æœ€é«˜é‡‘é¢ = 1 + 3 = 4 ã€‚
```

**ç¤ºä¾‹ 3ï¼š**
```
è¾“å…¥ï¼šnums = [1,2,3]
è¾“å‡ºï¼š3
```

**æç¤ºï¼š**
- `1 <= nums.length <= 100`
- `0 <= nums[i] <= 1000`

---

## ğŸ’¡ è§£é¢˜æ€è·¯

è¿™æ˜¯ [198. æ‰“å®¶åŠ«èˆ](./198.md) çš„è¿›é˜¶ç‰ˆï¼ŒåŒºåˆ«åœ¨äºæˆ¿å±‹**å›´æˆä¸€åœˆ**ï¼Œå¯¼è‡´ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæˆ¿å±‹ç›¸é‚»ã€‚

### æ ¸å¿ƒæ€è·¯ï¼šåˆ†æƒ…å†µè®¨è®º

ç”±äºæˆ¿å±‹æˆç¯ï¼Œç¬¬ä¸€ä¸ªæˆ¿å±‹ `nums[0]` å’Œæœ€åä¸€ä¸ªæˆ¿å±‹ `nums[n-1]` ä¸èƒ½åŒæ—¶è¢«å·ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªå­é—®é¢˜ï¼š

1. **æƒ…å†µä¸€ï¼šå·ç¬¬ä¸€ä¸ªæˆ¿å±‹ `nums[0]`**
   - é‚£ä¹ˆä¸èƒ½å·æœ€åä¸€ä¸ªæˆ¿å±‹ `nums[n-1]`
   - ä¹Ÿä¸èƒ½å·ç¬¬äºŒä¸ªæˆ¿å±‹ `nums[1]`ï¼ˆç›¸é‚»ï¼‰
   - é—®é¢˜å˜æˆï¼šåœ¨ `nums[2...n-2]` ä¸­çš„æ‰“å®¶åŠ«èˆé—®é¢˜

2. **æƒ…å†µäºŒï¼šä¸å·ç¬¬ä¸€ä¸ªæˆ¿å±‹ `nums[0]`**
   - å¯ä»¥è€ƒè™‘å·æœ€åä¸€ä¸ªæˆ¿å±‹
   - é—®é¢˜å˜æˆï¼šåœ¨ `nums[1...n-1]` ä¸­çš„æ‰“å®¶åŠ«èˆé—®é¢˜

**æœ€ç»ˆç­”æ¡ˆ** = max(æƒ…å†µä¸€, æƒ…å†µäºŒ)

### ä¸ºä»€ä¹ˆè¿™æ ·æ˜¯å¯¹çš„ï¼Ÿ

- å¦‚æœæœ€ä¼˜è§£åŒ…å« `nums[0]`ï¼Œé‚£ä¹ˆä¸€å®šä¸åŒ…å« `nums[n-1]`ï¼Œå±äºæƒ…å†µä¸€
- å¦‚æœæœ€ä¼˜è§£ä¸åŒ…å« `nums[0]`ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ˜¯ `nums[1...n-1]`ï¼Œå±äºæƒ…å†µäºŒ
- è¿™ä¸¤ç§æƒ…å†µè¦†ç›–äº†æ‰€æœ‰å¯èƒ½æ€§ï¼Œå–æœ€å¤§å€¼å³å¯

### å›¾è§£ç¤ºä¾‹

å¯¹äº `nums = [1,2,3,1]`ï¼š

```
ç¯å½¢ç»“æ„ï¼š
   1 --- 2
   |     |
   1 --- 3

æƒ…å†µä¸€ï¼šé€‰ nums[0] = 1
  - ä¸èƒ½é€‰ nums[1] = 2 å’Œ nums[3] = 1
  - å¯é€‰èŒƒå›´ï¼šnums[2...2] = [3]
  - æœ€å¤§é‡‘é¢ï¼š1 + 3 = 4

æƒ…å†µäºŒï¼šä¸é€‰ nums[0]
  - å¯é€‰èŒƒå›´ï¼šnums[1...3] = [2,3,1]
  - æ‰“å®¶åŠ«èˆ Iï¼šmax(2, 3) = 3

ç­”æ¡ˆï¼šmax(4, 3) = 4
```

---

## ğŸ’» ä»£ç å®ç°

### æ–¹æ³•ï¼šåˆ†æƒ…å†µ + æ‰“å®¶åŠ«èˆ I

```cpp
class Solution {
public:
    int rob(vector<int>& nums) {
        int n = nums.size();

        // ç‰¹æ®Šæƒ…å†µ
        if (n == 1) return nums[0];
        if (n == 2) return max(nums[0], nums[1]);

        // æƒ…å†µä¸€ï¼šå·ç¬¬ä¸€ä¸ªæˆ¿å±‹ï¼ŒèŒƒå›´ [2, n-2]
        // æƒ…å†µäºŒï¼šä¸å·ç¬¬ä¸€ä¸ªæˆ¿å±‹ï¼ŒèŒƒå›´ [1, n-1]
        return max(nums[0] + rob1(nums, 2, n - 1),
                   rob1(nums, 1, n));
    }

private:
    // æ‰“å®¶åŠ«èˆ Iï¼šåœ¨ [start, end) èŒƒå›´å†…çš„æœ€å¤§é‡‘é¢
    int rob1(vector<int>& nums, int start, int end) {
        int dp0 = 0, dp1 = 0;

        for (int i = start; i < end; i++) {
            int newDp = max(dp1, dp0 + nums[i]);
            dp0 = dp1;
            dp1 = newDp;
        }

        return dp1;
    }
};
```

**ä»£ç è§£æï¼š**
- `rob1(nums, start, end)` æ˜¯æ‰“å®¶åŠ«èˆ I çš„è§£æ³•ï¼Œæ±‚ `[start, end)` èŒƒå›´å†…çš„æœ€å¤§é‡‘é¢
- ä¸»å‡½æ•°åˆ†ä¸¤ç§æƒ…å†µè°ƒç”¨ `rob1`ï¼š
  - é€‰ `nums[0]`ï¼šèŒƒå›´æ˜¯ `[2, n-1)`ï¼ŒåŠ ä¸Š `nums[0]`
  - ä¸é€‰ `nums[0]`ï¼šèŒƒå›´æ˜¯ `[1, n)`

**å¤æ‚åº¦åˆ†æï¼š**
- æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œä¸¤æ¬¡éå†æ•°ç»„
- ç©ºé—´å¤æ‚åº¦ï¼šO(1) âœ…

---

### ä»£ç ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆæ›´æ¸…æ™°ï¼‰

```cpp
class Solution {
public:
    int rob(vector<int>& nums) {
        int n = nums.size();

        // ç‰¹æ®Šæƒ…å†µ
        if (n == 1) return nums[0];
        if (n == 2) return max(nums[0], nums[1]);

        // æƒ…å†µä¸€ï¼šä¸è€ƒè™‘æœ€åä¸€ä¸ªæˆ¿å±‹ï¼ˆèŒƒå›´ [0, n-2]ï¼‰
        int case1 = robRange(nums, 0, n - 2);

        // æƒ…å†µäºŒï¼šä¸è€ƒè™‘ç¬¬ä¸€ä¸ªæˆ¿å±‹ï¼ˆèŒƒå›´ [1, n-1]ï¼‰
        int case2 = robRange(nums, 1, n - 1);

        return max(case1, case2);
    }

private:
    // åœ¨ [start, end] èŒƒå›´å†…çš„æ‰“å®¶åŠ«èˆ I
    int robRange(vector<int>& nums, int start, int end) {
        int dp0 = 0, dp1 = 0;

        for (int i = start; i <= end; i++) {
            int newDp = max(dp1, dp0 + nums[i]);
            dp0 = dp1;
            dp1 = newDp;
        }

        return dp1;
    }
};
```

**æ€è·¯å¯¹æ¯”ï¼š**

| å†™æ³• | æƒ…å†µä¸€ | æƒ…å†µäºŒ | è¯´æ˜ |
|------|--------|--------|------|
| åŸé¢˜è§£ | `nums[0] + rob([2, n-2])` | `rob([1, n-1])` | æ˜ç¡®é€‰æ‹© nums[0] |
| ä¼˜åŒ–ç‰ˆ | `rob([0, n-2])` | `rob([1, n-1])` | ä¸è€ƒè™‘æœ€å/ç¬¬ä¸€ä¸ª |

ä¸¤ç§å†™æ³•æœ¬è´¨ç›¸åŒï¼Œä¼˜åŒ–ç‰ˆæ›´ç›´è§‚ã€‚

---

## ğŸ” æ³¨æ„äº‹é¡¹ä¸æŠ€å·§

### æ˜“é”™ç‚¹

1. **ç¯å½¢ç»“æ„çš„ç†è§£**
   - ä¸æ˜¯æ‰€æœ‰æˆ¿å±‹éƒ½è¦å·ï¼Œåªæ˜¯é¦–å°¾ä¸èƒ½åŒæ—¶å·
   - åˆ†æƒ…å†µè®¨è®ºæ—¶ï¼Œè¦ä¿è¯ä¸é—æ¼ã€ä¸é‡å¤

2. **è¾¹ç•Œæ¡ä»¶**
   - `n == 1`ï¼šåªæœ‰ä¸€ä¸ªæˆ¿å±‹ï¼Œç›´æ¥è¿”å›
   - `n == 2`ï¼šä¸¤ä¸ªæˆ¿å±‹åªèƒ½å·ä¸€ä¸ªï¼Œè¿”å›è¾ƒå¤§å€¼

3. **èŒƒå›´çš„ç¡®å®š**
   - æƒ…å†µä¸€ï¼šé€‰ `nums[0]`ï¼Œä¸èƒ½é€‰ `nums[1]` å’Œ `nums[n-1]`
   - æƒ…å†µäºŒï¼šä¸é€‰ `nums[0]`ï¼Œå¯ä»¥è€ƒè™‘æ‰€æœ‰ `nums[1...n-1]`

### è§£é¢˜æŠ€å·§

1. **åŒ–ç¯ä¸ºé“¾**
   - ç¯å½¢é—®é¢˜ â†’ åˆ†æƒ…å†µè®¨è®º â†’ è½¬åŒ–ä¸ºé“¾å¼é—®é¢˜
   - è¿™æ˜¯å¤„ç†ç¯å½¢ DP çš„å¸¸ç”¨æŠ€å·§

2. **å¤ç”¨å­é—®é¢˜**
   - æ‰“å®¶åŠ«èˆ II å¯ä»¥å¤ç”¨æ‰“å®¶åŠ«èˆ I çš„ä»£ç 
   - åªéœ€è¦åœ¨ä¸åŒèŒƒå›´å†…è°ƒç”¨

3. **åˆ†ç±»è®¨è®ºçš„å®Œå¤‡æ€§**
   - ç¡®ä¿åˆ†ç±»è¦†ç›–æ‰€æœ‰æƒ…å†µ
   - æƒ…å†µä¹‹é—´ä¸é‡å 

### çŠ¶æ€è½¬ç§»è¿‡ç¨‹ç¤ºä¾‹

å¯¹äº `nums = [2,3,2]`ï¼š

```
æƒ…å†µä¸€ï¼šrob([0, n-2]) = rob([2, 3])
  dp è¿‡ç¨‹ï¼š
  i=0: dp = [0, 2]     é€‰ nums[0]=2
  i=1: dp = [2, 3]     é€‰ nums[1]=3
  ç»“æœï¼š3

æƒ…å†µäºŒï¼šrob([1, n-1]) = rob([3, 2])
  dp è¿‡ç¨‹ï¼š
  i=1: dp = [0, 3]     é€‰ nums[1]=3
  i=2: dp = [3, 3]     ä¸é€‰ nums[2]=2
  ç»“æœï¼š3

ç­”æ¡ˆï¼šmax(3, 3) = 3
```

---

## ğŸ“Š ç›¸å…³é¢˜ç›®

- [198. æ‰“å®¶åŠ«èˆ](./198.md)ï¼ˆåŸºç¡€ç‰ˆï¼‰
- [337. æ‰“å®¶åŠ«èˆ III](https://leetcode.cn/problems/house-robber-iii/)ï¼ˆæ ‘å½¢ DPï¼‰
- [740. åˆ é™¤å¹¶è·å¾—ç‚¹æ•°](./740.md)ï¼ˆå˜å½¢é¢˜ï¼‰

---

## ğŸ’ª è§£é¢˜æ€è·¯æ€»ç»“

### ä» 198 åˆ° 213 çš„è¿›åŒ–

| ç‰¹å¾ | 198. æ‰“å®¶åŠ«èˆ | 213. æ‰“å®¶åŠ«èˆ II |
|------|-------------|----------------|
| ç»“æ„ | çº¿æ€§ | ç¯å½¢ |
| çº¦æŸ | ç›¸é‚»ä¸èƒ½å· | ç›¸é‚» + é¦–å°¾ä¸èƒ½åŒæ—¶å· |
| è§£æ³• | ç›´æ¥ DP | åˆ†æƒ…å†µ + å¤ç”¨æ‰“å®¶åŠ«èˆ I |

### ç¯å½¢ DP çš„é€šç”¨æ€è·¯

1. **è¯†åˆ«ç¯å½¢çº¦æŸ**ï¼šé¦–å°¾å…ƒç´ çš„ç‰¹æ®Šå…³ç³»
2. **ç ´ç¯æˆé“¾**ï¼šåˆ†æƒ…å†µè®¨è®ºï¼Œå»æ‰é¦–æˆ–å°¾
3. **å¤ç”¨çº¿æ€§è§£æ³•**ï¼šåœ¨ä¸åŒèŒƒå›´å†…åº”ç”¨
4. **åˆå¹¶ç»“æœ**ï¼šå–æ‰€æœ‰æƒ…å†µçš„æœ€ä¼˜è§£

---

## ğŸ¯ åˆ·é¢˜å»ºè®®

å»ºè®®æŒ‰é¡ºåºåˆ·ï¼š
1. [198. æ‰“å®¶åŠ«èˆ](./198.md) - ç†è§£åŸºç¡€æ¨¡å‹
2. **213. æ‰“å®¶åŠ«èˆ II** - æŒæ¡ç¯å½¢å¤„ç†
3. [337. æ‰“å®¶åŠ«èˆ III](https://leetcode.cn/problems/house-robber-iii/) - æ‹“å±•åˆ°æ ‘å½¢ç»“æ„

é€šè¿‡è¿™ä¸‰é¢˜ï¼Œå¯ä»¥ç³»ç»ŸæŒæ¡"æ‰“å®¶åŠ«èˆ"ç³»åˆ—çš„è§£é¢˜æ€è·¯ã€‚
